–û—à–∏–±–∫–∞:

The server requested SCRAM-based authentication, but no password was provided.


–≥–æ–≤–æ—Ä–∏—Ç –æ –≥–ª–∞–≤–Ω–æ–º:

üëâ Spring –Ω–µ –ø–æ–¥—Å—Ç–∞–≤–∏–ª –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ ${DB_PASSWORD} –≤ hibernate.connection.password
–∏ –≤ –∏—Ç–æ–≥–µ –≤ datasource –ø–∞—Ä–æ–ª—å = null.

–î–æ —Ç–æ–≥–æ –∫–∞–∫ –≤—ã –∑–∞–º–µ–Ω–∏–ª–∏ –ø–∞—Ä–æ–ª—å –Ω–∞ ${DB_PASSWORD}, –≤—Å—ë —Ä–∞–±–æ—Ç–∞–ª–æ ‚Äî –∑–Ω–∞—á–∏—Ç, –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Hibernate, –∞ –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.

‚úÖ –ü–æ—á–µ–º—É Spring –Ω–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç ${DB_PASSWORD}

–í @PropertySource("classpath:hibernate.properties") Spring –Ω–µ –¥–µ–ª–∞–µ—Ç –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–í .properties —Ñ–∞–π–ª–µ –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ${ENV_VAR} –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ ‚Äî Spring –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ env variables –≤–Ω—É—Ç—Ä–∏ @PropertySource.

–ü–æ—ç—Ç–æ–º—É:

hibernate.connection.password=${DB_PASSWORD}


–æ—Å—Ç–∞—ë—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π "${DB_PASSWORD}", Spring –ø–µ—Ä–µ–¥–∞—ë—Ç —ç—Ç–æ –≤ datasource ‚Äî –ø–∞—Ä–æ–ª—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±—É–∫–≤–∞–ª—å–Ω—ã–º "${DB_PASSWORD}", –∏–ª–∏ –¥–∞–∂–µ null.

‚úÖ –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (3 –≤–∞—Ä–∏–∞–Ω—Ç–∞)
‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 1: –í–∫–ª—é—á–∏—Ç—å PropertySourcesPlaceholderConfigurer (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–î–æ–±–∞–≤—å—Ç–µ –≤ SpringConfig:

@Bean
public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
    return new PropertySourcesPlaceholderConfigurer();
}


–¢–µ–ø–µ—Ä—å ${DB_PASSWORD} –±—É–¥–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è.

‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Spring Boot —Å—Ç–∏–ª—å (–µ—Å–ª–∏ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ)

–í–º–µ—Å—Ç–æ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ hibernate.properties, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ application.properties:

spring.datasource.url=jdbc:postgresql://localhost:5432/weather_db
spring.datasource.username=postgres
spring.datasource.password=${DB_PASSWORD}


Spring Boot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 3: –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –≤ System Properties (–µ—Å–ª–∏ Tomcat)

–ó–∞–ø—É—Å–∫ Tomcat:

SET DB_PASSWORD=yourpassword


–∏–ª–∏ –≤ Linux:

export DB_PASSWORD=yourpassword


–ù–û —ç—Ç–æ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–µ 1, –ø–æ—Ç–æ–º—É —á—Ç–æ –±–µ–∑ PropertySourcesPlaceholderConfigurer Spring –Ω–µ —É–º–µ–µ—Ç –º–∞–ø–∏—Ç—å env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ @PropertySource.

‚ùå –ü–æ—á–µ–º—É —Å DriverManagerDataSource –≤—Å—ë –ª–æ–º–∞–µ—Ç—Å—è

–ü–æ—Ç–æ–º—É —á—Ç–æ:

ds.setPassword(env.getRequiredProperty("hibernate.connection.password"));


–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–∏–±–æ "${DB_PASSWORD}", –ª–∏–±–æ –∫–∏–¥–∞–µ—Ç –æ—à–∏–±–∫—É.

üî• –ü–æ—á–µ–º—É Flyway —Ä–∞–±–æ—Ç–∞–µ—Ç, –∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ‚Äî –Ω–µ—Ç?

Flyway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ DataSource.
–ù–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –¥–æ –ø–µ—Ä–≤–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –±–∞–∑–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç–æ –≤ –ø—É–ª–µ –∏–ª–∏ –∫—ç—à–µ.

–û—à–∏–±–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–æ—Å—Ç—É–ø–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Äî datasource –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ –ø–∞—Ä–æ–ª—è –Ω–µ—Ç.

üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–∞—Ä–æ–ª—å —Ä–µ–∞–ª—å–Ω–æ –Ω–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è?

–î–æ–±–∞–≤—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ:

System.out.println("PASSWORD >>> " + env.getRequiredProperty("hibernate.connection.password"));


–í—ã —É–≤–∏–¥–∏—Ç–µ:

PASSWORD >>> ${DB_PASSWORD}

üéØ –ò—Ç–æ–≥
‚ùó –ß—Ç–æ–±—ã –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ ‚Äî –¥–æ–±–∞–≤—å—Ç–µ:
@Bean
public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
    return new PropertySourcesPlaceholderConfigurer();
}


–∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è DB_PASSWORD —Ä–µ–∞–ª—å–Ω–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ Spring –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –ø–∞—Ä–æ–ª—å.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –º–æ–≥—É –ø–æ–º–æ—á—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∞ HikariCP –∏–ª–∏ Spring Boot.